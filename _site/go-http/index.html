<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <link rel="icon" href="/favicon.ico" sizes="32x32" type="image/x-icon">

    <!--  Apple  -->
    <link rel="apple-touch-icon-precomposed" href="/imgs/favicon/apple-touch-icon-precomposed.png">

    <!--  Microsoft  -->
    <meta name="msapplication-TileColor" content="#D8F0CC">
    <meta name="msapplication-TileImage" content="/imgs/favicon/tileicon.png">

    <!-- General page specifics -->

    <!-- title variable -->
    

        

    

    <!-- url variable -->
    

        

    

    <!-- author variable -->
    

        

    

    <!-- keywords variable -->
    

    <title>Go's http package by example | Cryptic Chat</title>
    <meta name="description" content="We are a group of developers involved in the tech industry that work, laugh, discover, and grow together. We encourage each other to push the boundaries of the technology we work with everyday. To help reach our personal goals we collaborating often and want others to share in this  experience.
">
    <meta name="keywords" content="                                    golang,                            http,                            middleware,                        ">
    <meta name="author" content="Chris Dolphin">

    <!-- Facebook page specifics -->
    <meta property="og:title" content="Go's http package by example | Cryptic Chat">
    <meta property="og:description" content="We are a group of developers involved in the tech industry that work, laugh, discover, and grow together. We encourage each other to push the boundaries of the technology we work with everyday. To help reach our personal goals we collaborating often and want others to share in this  experience.
">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Cryptic Chat">
    <meta property="og:image" content="">

    <!-- Twitter page specifics -->
    <meta name="twitter:title" content="Go's http package by example | Cryptic Chat">
    <meta name="twitter:description" content="We are a group of developers involved in the tech industry that work, laugh, discover, and grow together. We encourage each other to push the boundaries of the technology we work with everyday. To help reach our personal goals we collaborating often and want others to share in this  experience.
">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:url" content="/go-http/">
    <meta name="twitter:site" content="@likethemammal">
    <meta name="twitter:image" content="">


    <link rel="stylesheet" href="/styles.css">
    <link rel="canonical" href="https://cryptic.io/go-http/">

    <link href="//fonts.googleapis.com/css?family=Open+Sans:400italic,400,600" rel="stylesheet" type="text/css">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-37560411-4', 'auto');
    ga('require', 'displayfeatures');
    ga('send', 'pageview');

</script>

</head>


  

  <body>

  

    <div id="nav-band">
    <div id="nav">
        <a id="logo" href="/">
            <i class="fa fa-users"></i>
            Cryptic: chat
        </a>

        <nav id="desktop-nav">
            <a class="nav-item" href="/search" title="Search">Search</a>
            <a class="nav-item" href="/tags" title="Tags">Tags</a>
            <a class="nav-item" href="/members" title="Members">Members</a>
            <a class="nav-item" href="http://github.com/cryptic-io/cryptic-chat/" title="Github Repo">Github</a>
            <a class="nav-item" href="/about" title="About">About</a>
            <a class="nav-item" href="/" title="Blog">Blog</a>
        </nav>

        <input id="mobile-nav-open" class="mobile-nav-toggle" type="text" readonly>
        <input id="mobile-nav-close" class="mobile-nav-toggle" type="text" readonly>

        <nav id="mobile-nav">
            <a class="nav-item" href="/" title="Blog">Blog</a>
            <a class="nav-item" href="/about" title="About">About</a>
            <a class="nav-item" href="http://github.com/cryptic-io/cryptic-chat/" title="Github Repo">Github</a>
            <a class="nav-item" href="/members" title="Members">Members</a>
            <a class="nav-item" href="/tags" title="Tags">Tags</a>
            <a class="nav-item" href="/search" title="Search">Search</a>
        </nav>

    </div>
</div>


    <div id="main">

        







    <div id="post">

        <header id="post-header" class="cf">

            <a href="#author" title="Author">
                <div id="post-author-avatar">
                    <img id="post-author-img-bg" src="https://avatars.githubusercontent.com/u/933154" alt="Brian Picciano background" title="Brian Picciano background"/>
                    <img id="post-author-img" src="https://avatars.githubusercontent.com/u/933154" alt="Brian Picciano Avatar Image" title="Brian Picciano"/>
                </div>
            </a>

            <div id="post-header-words">

                <h1 id="post-title">

                    <span id="post-title-text">
                        Go's http package by example
                    </span>

                    <div id="post-tags">
                        
                            <a class="post-tag" href="/tags#golang" title="golang">#golang</a>
                        
                            <a class="post-tag" href="/tags#http" title="http">#http</a>
                        
                            <a class="post-tag" href="/tags#middleware" title="middleware">#middleware</a>
                        
                    </div>
                </h1>

                <div id="post-metadata">
                    <span id="post-date">Jul 15, 2015</span>
                    â€¢
                    <a id="disqus-num-comments" href="#disqus_thread" title="To the comments">0 comments</a>
                </div>

            </div>

        </header>

        <div id="post-assets">

            

            

        </div>

        

        <article id="post-content">

            <h1>Go&#39;s http package by example</h1>

<p>Go&#39;s <a href="http://golang.org/pkg/net/http/">http</a> package has turned into one of my
favorite things about the Go programming language. Initially it appears to be
somewhat complex, but in reality it can be broken down into a couple of simple
components that are extremely flexible in how they can be used. This guide will
cover the basic ideas behind the http package, as well as examples in using,
testing, and composing apps built with it.</p>

<p>This guide assumes you have some basic knowledge of what an interface in Go is,
and some idea of how HTTP works and what it can do.</p>

<h2>Handler</h2>

<p>The building block of the entire http package is the <code>http.Handler</code> interface,
which is defined as follows:</p>
<div class="highlight"><pre><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">Handler</span> <span class="kd">interface</span> <span class="p">{</span>
    <span class="nx">ServeHTTP</span><span class="p">(</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="o">*</span><span class="nx">Request</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>Once implemented the <code>http.Handler</code> can be passed to <code>http.ListenAndServe</code>,
which will call the <code>ServeHTTP</code> method on every incoming request.</p>

<p><code>http.Request</code> contains all relevant information about an incoming http request
which is being served by your <code>http.Handler</code>.</p>

<p>The <code>http.ResponseWriter</code> is the interface through which you can respond to the
request. It implements the <code>io.Writer</code> interface, so you can use methods like
<code>fmt.Fprintf</code> to write a formatted string as the response body, or ones like
<code>io.Copy</code> to write out the contents of a file (or any other <code>io.Reader</code>). The
response code can be set before you begin writing data using the <code>WriteHeader</code>
method.</p>

<p>Here&#39;s an example of an extremely simple http server:</p>
<div class="highlight"><pre><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;fmt&quot;</span>
    <span class="s">&quot;log&quot;</span>
    <span class="s">&quot;net/http&quot;</span>
<span class="p">)</span>

<span class="kd">type</span> <span class="nx">helloHandler</span> <span class="kd">struct</span><span class="p">{}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">h</span> <span class="nx">helloHandler</span><span class="p">)</span> <span class="nx">ServeHTTP</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprintf</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&quot;hello, you&#39;ve hit %s\n&quot;</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">URL</span><span class="p">.</span><span class="nx">Path</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">err</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ListenAndServe</span><span class="p">(</span><span class="s">&quot;:9999&quot;</span><span class="p">,</span> <span class="nx">helloHandler</span><span class="p">{})</span>
    <span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p><code>http.ListenAndServe</code> serves requests using the handler, listening on the given
address:port. It will block unless it encounters an error listening, in which
case we <code>log.Fatal</code>.</p>

<p>Here&#39;s an example of using this handler with curl:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> ~ $ curl localhost:9999/foo/bar
 hello, you&#39;ve hit /foo/bar
</code></pre></div>
<h2>HandlerFunc</h2>

<p>Often defining a full type to implement the <code>http.Handler</code> interface is a bit
overkill, especially for extremely simple <code>ServeHTTP</code> functions like the one
above. The <code>http</code> package provides a helper function, <code>http.HandlerFunc</code>, which
wraps a function which has the signature
<code>func(w http.ResponseWriter, r *http.Request)</code>, returning an <code>http.Handler</code>
which will call it in all cases.</p>

<p>The following behaves exactly like the previous example, but uses
<code>http.HandlerFunc</code> instead of defining a new type.</p>
<div class="highlight"><pre><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;fmt&quot;</span>
    <span class="s">&quot;log&quot;</span>
    <span class="s">&quot;net/http&quot;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">h</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">HandlerFunc</span><span class="p">(</span><span class="kd">func</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprintf</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&quot;hello, you&#39;ve hit %s\n&quot;</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">URL</span><span class="p">.</span><span class="nx">Path</span><span class="p">)</span>
    <span class="p">})</span>

    <span class="nx">err</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ListenAndServe</span><span class="p">(</span><span class="s">&quot;:9999&quot;</span><span class="p">,</span> <span class="nx">h</span><span class="p">)</span>
    <span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<h2>ServeMux</h2>

<p>On their own, the previous examples don&#39;t seem all that useful. If we wanted to
have different behavior for different endpoints we would end up with having to
parse path strings as well as numerous <code>if</code> or <code>switch</code> statements.  Luckily
we&#39;re provided with <code>http.ServeMux</code>, which does all of that for us.  Here&#39;s an
example of it being used:</p>
<div class="highlight"><pre><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;fmt&quot;</span>
    <span class="s">&quot;log&quot;</span>
    <span class="s">&quot;net/http&quot;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">h</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">NewServeMux</span><span class="p">()</span>

    <span class="nx">h</span><span class="p">.</span><span class="nx">HandleFunc</span><span class="p">(</span><span class="s">&quot;/foo&quot;</span><span class="p">,</span> <span class="kd">func</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprintln</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&quot;Hello, you hit foo!&quot;</span><span class="p">)</span>
    <span class="p">})</span>

    <span class="nx">h</span><span class="p">.</span><span class="nx">HandleFunc</span><span class="p">(</span><span class="s">&quot;/bar&quot;</span><span class="p">,</span> <span class="kd">func</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprintln</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&quot;Hello, you hit bar!&quot;</span><span class="p">)</span>
    <span class="p">})</span>

    <span class="nx">h</span><span class="p">.</span><span class="nx">HandleFunc</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">,</span> <span class="kd">func</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">w</span><span class="p">.</span><span class="nx">WriteHeader</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprintln</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&quot;You&#39;re lost, go home&quot;</span><span class="p">)</span>
    <span class="p">})</span>

    <span class="nx">err</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ListenAndServe</span><span class="p">(</span><span class="s">&quot;:9999&quot;</span><span class="p">,</span> <span class="nx">h</span><span class="p">)</span>
    <span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>The <code>http.ServeMux</code> is itself an <code>http.Handler</code>, so it can be passed into
<code>http.ListenAndServe</code>. When it receives a request it will check if the request&#39;s
path is prefixed by any of its known paths, choosing the longest prefix match it
can find. We use the <code>/</code> endpoint as a catch-all to catch any requests to
unknown endpoints. Here&#39;s some examples of it being used:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> ~ $ curl localhost:9999/foo
Hello, you hit foo!

 ~ $ curl localhost:9999/bar
Hello, you hit bar!

 ~ $ curl localhost:9999/baz
You&#39;re lost, go home
</code></pre></div>
<p><code>http.ServeMux</code> has both <code>Handle</code> and <code>HandleFunc</code> methods. These do the same
thing, except that <code>Handle</code> takes in an <code>http.Handler</code> while <code>HandleFunc</code> merely
takes in a function, implicitly wrapping it just as <code>http.HandlerFunc</code> does.</p>

<h3>Other muxes</h3>

<p>There are numerous replacements for <code>http.ServeMux</code> like
<a href="http://www.gorillatoolkit.org/pkg/mux">gorilla/mux</a> which give you things like
automatically pulling variables out of paths, easily asserting what http methods
are allowed on an endpoint, and more. Most of these replacements will implement
<code>http.Handler</code> like <code>http.ServeMux</code> does, and accept <code>http.Handler</code>s as
arguments, and so are easy to use in conjunction with the rest of the things
I&#39;m going to talk about in this post.</p>

<h2>Composability</h2>

<p>When I say that the <code>http</code> package is composable I mean that it is very easy to
create re-usable pieces of code and glue them together into a new working
application. The <code>http.Handler</code> interface is the way all pieces communicate with
each other. Here&#39;s an example of where we use the same <code>http.Handler</code> to handle
multiple endpoints, each slightly differently:</p>
<div class="highlight"><pre><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;fmt&quot;</span>
    <span class="s">&quot;log&quot;</span>
    <span class="s">&quot;net/http&quot;</span>
<span class="p">)</span>

<span class="kd">type</span> <span class="nx">numberDumper</span> <span class="kt">int</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">n</span> <span class="nx">numberDumper</span><span class="p">)</span> <span class="nx">ServeHTTP</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprintf</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&quot;Here&#39;s your number: %d\n&quot;</span><span class="p">,</span> <span class="nx">n</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">h</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">NewServeMux</span><span class="p">()</span>

    <span class="nx">h</span><span class="p">.</span><span class="nx">Handle</span><span class="p">(</span><span class="s">&quot;/one&quot;</span><span class="p">,</span> <span class="nx">numberDumper</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="nx">h</span><span class="p">.</span><span class="nx">Handle</span><span class="p">(</span><span class="s">&quot;/two&quot;</span><span class="p">,</span> <span class="nx">numberDumper</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="nx">h</span><span class="p">.</span><span class="nx">Handle</span><span class="p">(</span><span class="s">&quot;/three&quot;</span><span class="p">,</span> <span class="nx">numberDumper</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
    <span class="nx">h</span><span class="p">.</span><span class="nx">Handle</span><span class="p">(</span><span class="s">&quot;/four&quot;</span><span class="p">,</span> <span class="nx">numberDumper</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
    <span class="nx">h</span><span class="p">.</span><span class="nx">Handle</span><span class="p">(</span><span class="s">&quot;/five&quot;</span><span class="p">,</span> <span class="nx">numberDumper</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>

    <span class="nx">h</span><span class="p">.</span><span class="nx">HandleFunc</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">,</span> <span class="kd">func</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">w</span><span class="p">.</span><span class="nx">WriteHeader</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprintln</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&quot;That&#39;s not a supported number!&quot;</span><span class="p">)</span>
    <span class="p">})</span>

    <span class="nx">err</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ListenAndServe</span><span class="p">(</span><span class="s">&quot;:9999&quot;</span><span class="p">,</span> <span class="nx">h</span><span class="p">)</span>
    <span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p><code>numberDumper</code> implements <code>http.Handler</code>, and can be passed into the
<code>http.ServeMux</code> multiple times to serve multiple endpoints. Here&#39;s it in action:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> ~ $ curl localhost:9999/one
Here&#39;s your number: 1
 ~ $ curl localhost:9999/five
Here&#39;s your number: 5
 ~ $ curl localhost:9999/bazillion
That&#39;s not a supported number!
</code></pre></div>
<h2>Testing</h2>

<p>Testing http endpoints is extremely easy in Go, and doesn&#39;t even require you to
actually listen on any ports! The <code>httptest</code> package provides a few handy
utilities, including <code>NewRecorder</code> which implements <code>http.ResponseWriter</code> and
allows you to effectively make an http request by calling <code>ServeHTTP</code> directly.
Here&#39;s an example of a test for our previously implemented <code>numberDumper</code>,
commented with what exactly is happening:</p>
<div class="highlight"><pre><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;fmt&quot;</span>
    <span class="s">&quot;net/http&quot;</span>
    <span class="s">&quot;net/http/httptest&quot;</span>
    <span class="p">.</span> <span class="s">&quot;testing&quot;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nx">TestNumberDumper</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">T</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// We first create the http.Handler we wish to test</span>
    <span class="nx">n</span> <span class="o">:=</span> <span class="nx">numberDumper</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">// We create an http.Request object to test with. The http.Request is</span>
    <span class="c1">// totally customizable in every way that a real-life http request is, so</span>
    <span class="c1">// even the most intricate behavior can be tested</span>
    <span class="nx">r</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">NewRequest</span><span class="p">(</span><span class="s">&quot;GET&quot;</span><span class="p">,</span> <span class="s">&quot;/one&quot;</span><span class="p">,</span> <span class="kc">nil</span><span class="p">)</span>

    <span class="c1">// httptest.Recorder implements the http.ResponseWriter interface, and as</span>
    <span class="c1">// such can be passed into ServeHTTP to receive the response. It will act as</span>
    <span class="c1">// if all data being given to it is being sent to a real client, when in</span>
    <span class="c1">// reality it&#39;s being buffered for later observation</span>
    <span class="nx">w</span> <span class="o">:=</span> <span class="nx">httptest</span><span class="p">.</span><span class="nx">NewRecorder</span><span class="p">()</span>

    <span class="c1">// Pass in our httptest.Recorder and http.Request to our numberDumper. At</span>
    <span class="c1">// this point the numberDumper will act just as if it was responding to a</span>
    <span class="c1">// real request</span>
    <span class="nx">n</span><span class="p">.</span><span class="nx">ServeHTTP</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">r</span><span class="p">)</span>

    <span class="c1">// httptest.Recorder gives a number of fields and methods which can be used</span>
    <span class="c1">// to observe the response made to our request. Here we check the response</span>
    <span class="c1">// code</span>
    <span class="k">if</span> <span class="nx">w</span><span class="p">.</span><span class="nx">Code</span> <span class="o">!=</span> <span class="mi">200</span> <span class="p">{</span>
        <span class="nx">t</span><span class="p">.</span><span class="nx">Fatalf</span><span class="p">(</span><span class="s">&quot;wrong code returned: %d&quot;</span><span class="p">,</span> <span class="nx">w</span><span class="p">.</span><span class="nx">Code</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// We can also get the full body out of the httptest.Recorder, and check</span>
    <span class="c1">// that its contents are what we expect</span>
    <span class="nx">body</span> <span class="o">:=</span> <span class="nx">w</span><span class="p">.</span><span class="nx">Body</span><span class="p">.</span><span class="nx">String</span><span class="p">()</span>
    <span class="k">if</span> <span class="nx">body</span> <span class="o">!=</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">&quot;Here&#39;s your number: 1\n&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">t</span><span class="p">.</span><span class="nx">Fatalf</span><span class="p">(</span><span class="s">&quot;wrong body returned: %s&quot;</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>
<p>In this way it&#39;s easy to create tests for your individual components that you
are using to build your application, keeping the tests near to the functionality
they&#39;re testing.</p>

<p>Note: if you ever do need to spin up a test server in your tests, <code>httptest</code>
also provides a way to create a server listening on a random open port for use
in tests as well.</p>

<h2>Middleware</h2>

<p>Serving endpoints is nice, but often there&#39;s functionality you need to run for
<em>every</em> request before the actual endpoint&#39;s handler is run. For example, access
logging. A middleware component is one which implements <code>http.Handler</code>, but will
actually pass the request off to another <code>http.Handler</code> after doing some set of
actions. The <code>http.ServeMux</code> we looked at earlier is actually an example of
middleware, since it passes the request off to another <code>http.Handler</code> for actual
processing. Here&#39;s an example of our previous example with some logging
middleware:</p>
<div class="highlight"><pre><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;fmt&quot;</span>
    <span class="s">&quot;log&quot;</span>
    <span class="s">&quot;net/http&quot;</span>
<span class="p">)</span>

<span class="kd">type</span> <span class="nx">numberDumper</span> <span class="kt">int</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">n</span> <span class="nx">numberDumper</span><span class="p">)</span> <span class="nx">ServeHTTP</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprintf</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&quot;Here&#39;s your number: %d\n&quot;</span><span class="p">,</span> <span class="nx">n</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">logger</span><span class="p">(</span><span class="nx">h</span> <span class="nx">http</span><span class="p">.</span><span class="nx">Handler</span><span class="p">)</span> <span class="nx">http</span><span class="p">.</span><span class="nx">Handler</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">http</span><span class="p">.</span><span class="nx">HandlerFunc</span><span class="p">(</span><span class="kd">func</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">log</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;%s requested %s&quot;</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">RemoteAddr</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">URL</span><span class="p">)</span>
        <span class="nx">h</span><span class="p">.</span><span class="nx">ServeHTTP</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">r</span><span class="p">)</span>
    <span class="p">})</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">h</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">NewServeMux</span><span class="p">()</span>

    <span class="nx">h</span><span class="p">.</span><span class="nx">Handle</span><span class="p">(</span><span class="s">&quot;/one&quot;</span><span class="p">,</span> <span class="nx">numberDumper</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="nx">h</span><span class="p">.</span><span class="nx">Handle</span><span class="p">(</span><span class="s">&quot;/two&quot;</span><span class="p">,</span> <span class="nx">numberDumper</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="nx">h</span><span class="p">.</span><span class="nx">Handle</span><span class="p">(</span><span class="s">&quot;/three&quot;</span><span class="p">,</span> <span class="nx">numberDumper</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
    <span class="nx">h</span><span class="p">.</span><span class="nx">Handle</span><span class="p">(</span><span class="s">&quot;/four&quot;</span><span class="p">,</span> <span class="nx">numberDumper</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
    <span class="nx">h</span><span class="p">.</span><span class="nx">Handle</span><span class="p">(</span><span class="s">&quot;/five&quot;</span><span class="p">,</span> <span class="nx">numberDumper</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>

    <span class="nx">h</span><span class="p">.</span><span class="nx">HandleFunc</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">,</span> <span class="kd">func</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">w</span><span class="p">.</span><span class="nx">WriteHeader</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprintln</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&quot;That&#39;s not a supported number!&quot;</span><span class="p">)</span>
    <span class="p">})</span>

    <span class="nx">hl</span> <span class="o">:=</span> <span class="nx">logger</span><span class="p">(</span><span class="nx">h</span><span class="p">)</span>

    <span class="nx">err</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ListenAndServe</span><span class="p">(</span><span class="s">&quot;:9999&quot;</span><span class="p">,</span> <span class="nx">hl</span><span class="p">)</span>
    <span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p><code>logger</code> is a function which takes in an <code>http.Handler</code> called <code>h</code>, and returns
a new <code>http.Handler</code> which, when called, will log the request it was called with
and then pass off its arguments to <code>h</code>. To use it we pass in our
<code>http.ServeMux</code>, so all incoming requests will first be handled by the logging
middleware before being passed to the <code>http.ServeMux</code>.</p>

<p>Here&#39;s an example log entry which is output when the <code>/five</code> endpoint is hit:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">2015/06/30 20:15:41 [::1]:34688 requested /five
</code></pre></div>
<h2>Middleware chaining</h2>

<p>Being able to chain middleware together is an incredibly useful ability which we
get almost for free, as long as we use the signature
<code>func(http.Handler) http.Handler</code>. A middleware component returns the same type
which is passed into it, so simply passing the output of one middleware
component into the other is sufficient.</p>

<p>However, more complex behavior with middleware can be tricky. For instance, what
if you want a piece of middleware which takes in a parameter upon creation?
Here&#39;s an example of just that, with a piece of middleware which will set a
header and its value for all requests:</p>
<div class="highlight"><pre><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;fmt&quot;</span>
    <span class="s">&quot;log&quot;</span>
    <span class="s">&quot;net/http&quot;</span>
<span class="p">)</span>

<span class="kd">type</span> <span class="nx">numberDumper</span> <span class="kt">int</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">n</span> <span class="nx">numberDumper</span><span class="p">)</span> <span class="nx">ServeHTTP</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprintf</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&quot;Here&#39;s your number: %d\n&quot;</span><span class="p">,</span> <span class="nx">n</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">logger</span><span class="p">(</span><span class="nx">h</span> <span class="nx">http</span><span class="p">.</span><span class="nx">Handler</span><span class="p">)</span> <span class="nx">http</span><span class="p">.</span><span class="nx">Handler</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">http</span><span class="p">.</span><span class="nx">HandlerFunc</span><span class="p">(</span><span class="kd">func</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">log</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;%s requested %s&quot;</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">RemoteAddr</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">URL</span><span class="p">)</span>
        <span class="nx">h</span><span class="p">.</span><span class="nx">ServeHTTP</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">r</span><span class="p">)</span>
    <span class="p">})</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">headerSetter</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">key</span><span class="p">,</span> <span class="nx">val</span> <span class="kt">string</span>
    <span class="nx">handler</span>  <span class="nx">http</span><span class="p">.</span><span class="nx">Handler</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">hs</span> <span class="nx">headerSetter</span><span class="p">)</span> <span class="nx">ServeHTTP</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">w</span><span class="p">.</span><span class="nx">Header</span><span class="p">().</span><span class="nx">Set</span><span class="p">(</span><span class="nx">hs</span><span class="p">.</span><span class="nx">key</span><span class="p">,</span> <span class="nx">hs</span><span class="p">.</span><span class="nx">val</span><span class="p">)</span>
    <span class="nx">hs</span><span class="p">.</span><span class="nx">handler</span><span class="p">.</span><span class="nx">ServeHTTP</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">r</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">newHeaderSetter</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">val</span> <span class="kt">string</span><span class="p">)</span> <span class="kd">func</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">Handler</span><span class="p">)</span> <span class="nx">http</span><span class="p">.</span><span class="nx">Handler</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kd">func</span><span class="p">(</span><span class="nx">h</span> <span class="nx">http</span><span class="p">.</span><span class="nx">Handler</span><span class="p">)</span> <span class="nx">http</span><span class="p">.</span><span class="nx">Handler</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">headerSetter</span><span class="p">{</span><span class="nx">key</span><span class="p">,</span> <span class="nx">val</span><span class="p">,</span> <span class="nx">h</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">h</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">NewServeMux</span><span class="p">()</span>

    <span class="nx">h</span><span class="p">.</span><span class="nx">Handle</span><span class="p">(</span><span class="s">&quot;/one&quot;</span><span class="p">,</span> <span class="nx">numberDumper</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="nx">h</span><span class="p">.</span><span class="nx">Handle</span><span class="p">(</span><span class="s">&quot;/two&quot;</span><span class="p">,</span> <span class="nx">numberDumper</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="nx">h</span><span class="p">.</span><span class="nx">Handle</span><span class="p">(</span><span class="s">&quot;/three&quot;</span><span class="p">,</span> <span class="nx">numberDumper</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
    <span class="nx">h</span><span class="p">.</span><span class="nx">Handle</span><span class="p">(</span><span class="s">&quot;/four&quot;</span><span class="p">,</span> <span class="nx">numberDumper</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
    <span class="nx">h</span><span class="p">.</span><span class="nx">Handle</span><span class="p">(</span><span class="s">&quot;/five&quot;</span><span class="p">,</span> <span class="nx">numberDumper</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>

    <span class="nx">h</span><span class="p">.</span><span class="nx">HandleFunc</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">,</span> <span class="kd">func</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">w</span><span class="p">.</span><span class="nx">WriteHeader</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprintln</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&quot;That&#39;s not a supported number!&quot;</span><span class="p">)</span>
    <span class="p">})</span>

    <span class="nx">hl</span> <span class="o">:=</span> <span class="nx">logger</span><span class="p">(</span><span class="nx">h</span><span class="p">)</span>
    <span class="nx">hhs</span> <span class="o">:=</span> <span class="nx">newHeaderSetter</span><span class="p">(</span><span class="s">&quot;X-FOO&quot;</span><span class="p">,</span> <span class="s">&quot;BAR&quot;</span><span class="p">)(</span><span class="nx">hl</span><span class="p">)</span>

    <span class="nx">err</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ListenAndServe</span><span class="p">(</span><span class="s">&quot;:9999&quot;</span><span class="p">,</span> <span class="nx">hhs</span><span class="p">)</span>
    <span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>And here&#39;s the curl output:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> ~ $ curl -i localhost:9999/three
 HTTP/1.1 200 OK
 X-Foo: BAR
 Date: Wed, 01 Jul 2015 00:39:48 GMT
 Content-Length: 22
 Content-Type: text/plain; charset=utf-8

 Here&#39;s your number: 3
</code></pre></div>
<p><code>newHeaderSetter</code> returns a function which accepts and returns an
<code>http.Handler</code>. Calling that returned function with an <code>http.Handler</code> then gets
you an <code>http.Handler</code> which will set the header given to <code>newHeaderSetter</code>
before continuing on to the given <code>http.Handler</code>.</p>

<p>This may seem like a strange way of organizing this; for this example the
signature for <code>newHeaderSetter</code> could very well have looked like this:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">func newHeaderSetter(key, val string, h http.Handler) http.Handler
</code></pre></div>
<p>And that implementation would have worked fine. But it would have been more
difficult to compose going forward. In the next section I&#39;ll show what I mean.</p>

<h2>Composing middleware with alice</h2>

<p><a href="https://github.com/justinas/alice">Alice</a> is a very simple and convenient
helper for working with middleware using the function signature we&#39;ve been using
thusfar. Alice is used to create and use chains of middleware. Chains can even
be appended to each other, giving even further flexibility. Here&#39;s our previous
example with a couple more headers being set, but also using alice to manage the
added complexity.</p>
<div class="highlight"><pre><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;fmt&quot;</span>
    <span class="s">&quot;log&quot;</span>
    <span class="s">&quot;net/http&quot;</span>

    <span class="s">&quot;github.com/justinas/alice&quot;</span>
<span class="p">)</span>

<span class="kd">type</span> <span class="nx">numberDumper</span> <span class="kt">int</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">n</span> <span class="nx">numberDumper</span><span class="p">)</span> <span class="nx">ServeHTTP</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprintf</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&quot;Here&#39;s your number: %d\n&quot;</span><span class="p">,</span> <span class="nx">n</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">logger</span><span class="p">(</span><span class="nx">h</span> <span class="nx">http</span><span class="p">.</span><span class="nx">Handler</span><span class="p">)</span> <span class="nx">http</span><span class="p">.</span><span class="nx">Handler</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">http</span><span class="p">.</span><span class="nx">HandlerFunc</span><span class="p">(</span><span class="kd">func</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">log</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;%s requested %s&quot;</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">RemoteAddr</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">URL</span><span class="p">)</span>
        <span class="nx">h</span><span class="p">.</span><span class="nx">ServeHTTP</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">r</span><span class="p">)</span>
    <span class="p">})</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">headerSetter</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">key</span><span class="p">,</span> <span class="nx">val</span> <span class="kt">string</span>
    <span class="nx">handler</span>  <span class="nx">http</span><span class="p">.</span><span class="nx">Handler</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">hs</span> <span class="nx">headerSetter</span><span class="p">)</span> <span class="nx">ServeHTTP</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">w</span><span class="p">.</span><span class="nx">Header</span><span class="p">().</span><span class="nx">Set</span><span class="p">(</span><span class="nx">hs</span><span class="p">.</span><span class="nx">key</span><span class="p">,</span> <span class="nx">hs</span><span class="p">.</span><span class="nx">val</span><span class="p">)</span>
    <span class="nx">hs</span><span class="p">.</span><span class="nx">handler</span><span class="p">.</span><span class="nx">ServeHTTP</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">r</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">newHeaderSetter</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">val</span> <span class="kt">string</span><span class="p">)</span> <span class="kd">func</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">Handler</span><span class="p">)</span> <span class="nx">http</span><span class="p">.</span><span class="nx">Handler</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kd">func</span><span class="p">(</span><span class="nx">h</span> <span class="nx">http</span><span class="p">.</span><span class="nx">Handler</span><span class="p">)</span> <span class="nx">http</span><span class="p">.</span><span class="nx">Handler</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">headerSetter</span><span class="p">{</span><span class="nx">key</span><span class="p">,</span> <span class="nx">val</span><span class="p">,</span> <span class="nx">h</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">h</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">NewServeMux</span><span class="p">()</span>

    <span class="nx">h</span><span class="p">.</span><span class="nx">Handle</span><span class="p">(</span><span class="s">&quot;/one&quot;</span><span class="p">,</span> <span class="nx">numberDumper</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="nx">h</span><span class="p">.</span><span class="nx">Handle</span><span class="p">(</span><span class="s">&quot;/two&quot;</span><span class="p">,</span> <span class="nx">numberDumper</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="nx">h</span><span class="p">.</span><span class="nx">Handle</span><span class="p">(</span><span class="s">&quot;/three&quot;</span><span class="p">,</span> <span class="nx">numberDumper</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
    <span class="nx">h</span><span class="p">.</span><span class="nx">Handle</span><span class="p">(</span><span class="s">&quot;/four&quot;</span><span class="p">,</span> <span class="nx">numberDumper</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>

    <span class="nx">fiveHS</span> <span class="o">:=</span> <span class="nx">newHeaderSetter</span><span class="p">(</span><span class="s">&quot;X-FIVE&quot;</span><span class="p">,</span> <span class="s">&quot;the best number&quot;</span><span class="p">)</span>
    <span class="nx">h</span><span class="p">.</span><span class="nx">Handle</span><span class="p">(</span><span class="s">&quot;/five&quot;</span><span class="p">,</span> <span class="nx">fiveHS</span><span class="p">(</span><span class="nx">numberDumper</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>

    <span class="nx">h</span><span class="p">.</span><span class="nx">HandleFunc</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">,</span> <span class="kd">func</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">w</span><span class="p">.</span><span class="nx">WriteHeader</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprintln</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&quot;That&#39;s not a supported number!&quot;</span><span class="p">)</span>
    <span class="p">})</span>

    <span class="nx">chain</span> <span class="o">:=</span> <span class="nx">alice</span><span class="p">.</span><span class="nx">New</span><span class="p">(</span>
        <span class="nx">newHeaderSetter</span><span class="p">(</span><span class="s">&quot;X-FOO&quot;</span><span class="p">,</span> <span class="s">&quot;BAR&quot;</span><span class="p">),</span>
        <span class="nx">newHeaderSetter</span><span class="p">(</span><span class="s">&quot;X-BAZ&quot;</span><span class="p">,</span> <span class="s">&quot;BUZ&quot;</span><span class="p">),</span>
        <span class="nx">logger</span><span class="p">,</span>
    <span class="p">).</span><span class="nx">Then</span><span class="p">(</span><span class="nx">h</span><span class="p">)</span>

    <span class="nx">err</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ListenAndServe</span><span class="p">(</span><span class="s">&quot;:9999&quot;</span><span class="p">,</span> <span class="nx">chain</span><span class="p">)</span>
    <span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>In this example all requests will have the headers <code>X-FOO</code> and <code>X-BAZ</code> set, but
the <code>/five</code> endpoint will <em>also</em> have the <code>X-FIVE</code> header set.</p>

<h2>Fin</h2>

<p>Starting with a simple idea of an interface, the <code>http</code> package allows us to
create for ourselves an incredibly useful and flexible (yet still rather simple)
ecosystem for building web apps with re-usable components, all without breaking
our static checks.</p>


        </article>

        <div id="post-share">
            <p id="post-share-cta">Did you like this article? Share it!</p>
            <div id="post-share-buttons">
                <a target="_blank" href="https://twitter.com/home?status=Go's http package by example https://cryptic.io/go-http/" title="Share on Twitter">
                    <svg id="post-share-twitter" class="post-share-button">
                        <use xlink:href="/imgs/svg.svg#svg-twitter" x="0" y="0" width="100%" height="100%"></use>
                    </svg>
                </a>
                <a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://cryptic.io/go-http/" title="Share on Facebook">
                    <svg id="post-share-facebook" class="post-share-button">
                        <use xlink:href="/imgs/svg.svg#svg-facebook" x="0" y="0" width="100%" height="100%"></use>
                    </svg>
                </a>
                <a target="_blank" href="https://plus.google.com/share?url=https://cryptic.io/go-http/" title="Share on Google">
                    <svg id="post-share-google" class="post-share-button">
                        <use xlink:href="/imgs/svg.svg#svg-google" x="0" y="0" width="100%" height="100%"></use>
                    </svg>
                </a>
            </div>
        </div>

    </div>

    <footer id="footer">

        <h2 class="page-sub-header">Author</h2>

        <div id="author">

            <div class="member">

    <div class="member-header">

        <div class="member-author-avatar">
            <img class="member-author-img" src="https://avatars.githubusercontent.com/u/933154"/>
        </div>

        <div class="member-author-words">
            <div class="member-author-name">
                <span>Brian Picciano</span>
                <span class="member-author-username">mediocregopher</span>
            </div>
            <p class="member-author-bio">Coding, climbing, longboarding, movie watcher, ginger. I love go, clojure, redis, and sometimes erlang.</p>

            <div class="member-author-companies">

                <i class="fa fa-building-o"></i>

                

                

                

                    <a href="http://grooveshark.com/" class="company-link">Grooveshark</a>

                

                

                

                

                

                

                

                

                

            </div>
        </div>

        <div class="member-author-socials">

            
            <a href="http://mediocregopher.com" class="member-author-social" title="Website of Brian Picciano">
                Website
            </a>
            

            
            <a href="mailto:mediocregopher@gmail.com" class="member-author-social" title="Email of Brian Picciano">
                Email
            </a>
            

            
            <a href="http://github.com/mediocregopher" class="member-author-social" title="Github of Brian Picciano">
                Github
            </a>
            

            
            <a href="https://twitter.com/mediocre_gopher" class="member-author-social" title="Twitter of Brian Picciano">
                Twitter
            </a>
            

            

        </div>

    </div>

    <div class="member-related-posts">

        <div class="member-related-posts-title">
            <h2 class="member-related-posts-title-text">Posts by mediocregopher</h2>
        </div>

        <ul class="member-related-posts-list">

            

            

            <li class="member-related-post cf">
                <i class="fa fa-angle-right"></i>
                <a href="/go-http/" title="Go's http package by example">
                    <span>Go's http package by example</span>
                </a>
            </li>

            

            <li class="member-related-post cf">
                <i class="fa fa-angle-right"></i>
                <a href="/rabbit-hole/" title="Rabbit Hole">
                    <span>Rabbit Hole</span>
                </a>
            </li>

            

            <li class="member-related-post cf">
                <i class="fa fa-angle-right"></i>
                <a href="/protip-sleep/" title="Protip - Bash Sleep">
                    <span>Protip - Bash Sleep</span>
                </a>
            </li>

            

            <li class="member-related-post cf">
                <i class="fa fa-angle-right"></i>
                <a href="/erlang-pitfalls/" title="Erlang Pitfalls">
                    <span>Erlang Pitfalls</span>
                </a>
            </li>

            

            <li class="member-related-post cf">
                <i class="fa fa-angle-right"></i>
                <a href="/clojure-diamond-square/" title="Random Terrain Generation, A Clojure Walkthrough">
                    <span>Random Terrain Generation, A Clojure Walkthrough</span>
                </a>
            </li>

            

        </ul>

        <a class="member-related-posts-all-link" href="/tags#mediocregopher" title="See all posts by mediocregopher">See all posts by mediocregopher</a>

    </div>

</div>


        </div>

        <h2 class="page-sub-header">Comments</h2>

        <div id="disqus_thread"></div>

    </footer>














    </div>

    <footer id="bottom-band" class="cf">

    

    <div id="bottom-recent" class="bottom-section">

        <h2 class="recent-posts-title page-sub-header">Recent Posts</h2>

        <ul class="recent-posts-list">

            

            

            

            <li class="recent-post cf">

                <div class="recent-post-words">

                    <div class="recent-post-title">

                        <h4 class="recent-post-title-text">
                            <a class="recent-post-title-text-link" href="/developing-gamepad-virtual-keyboard/" title="Considerations for developing a gamepad virtual keyboard, Part 1: The interface">
                                Considerations for developing a gamepad virtual keyboard, Part 1: The interface
                            </a>

                            
                            <a class="post-tag" href="/tags/" title="flux">#flux</a>
                            
                            <a class="post-tag" href="/tags/" title="daisywheeljs">#daisywheeljs</a>
                            
                            <a class="post-tag" href="/tags/" title="gamepad">#gamepad</a>
                            
                            <a class="post-tag" href="/tags/" title="html5">#html5</a>
                            

                        </h4>

                    </div>

                    <div class="recent-post-metadata">

                        <span class="recent-post-authoring-info">
                            <a href="/tags#likethemammal" class="recent-post-author-name" title="Chris Dolphin">Chris Dolphin</a>
                            â€¢
                            <span class="recent-post-date">12 Sep 2015</span>
                        </span>

                    </div>

                    <a class="recent-post-link" href="/developing-gamepad-virtual-keyboard/" title="Considerations for developing a gamepad virtual keyboard, Part 1: The interface"></a>

                </div>

                <div class="recent-post-author-avatar">
                    <a href="/members#likethemammal" title="likethemammal">
                        <img class="recent-post-author-img" src="https://avatars1.githubusercontent.com/u/3430841" alt="likethemammal Avatar Image" title="likethemammal"/>
                    </a>
                </div>

            </li>

            

            

            

            

            

            

            

            

            

            

            

            <li class="recent-post cf">

                <div class="recent-post-words">

                    <div class="recent-post-title">

                        <h4 class="recent-post-title-text">
                            <a class="recent-post-title-text-link" href="/intro-to-daisywheeljs/" title="Adding the DaisywheelJS onscreen-keyboard to HTML5 Gamepad projects">
                                Adding the DaisywheelJS onscreen-keyboard to HTML5 Gamepad projects
                            </a>

                            
                            <a class="post-tag" href="/tags/" title="daisywheeljs">#daisywheeljs</a>
                            
                            <a class="post-tag" href="/tags/" title="daisywheel">#daisywheel</a>
                            
                            <a class="post-tag" href="/tags/" title="gamepad">#gamepad</a>
                            
                            <a class="post-tag" href="/tags/" title="html5">#html5</a>
                            

                        </h4>

                    </div>

                    <div class="recent-post-metadata">

                        <span class="recent-post-authoring-info">
                            <a href="/tags#likethemammal" class="recent-post-author-name" title="Chris Dolphin">Chris Dolphin</a>
                            â€¢
                            <span class="recent-post-date">31 Aug 2015</span>
                        </span>

                    </div>

                    <a class="recent-post-link" href="/intro-to-daisywheeljs/" title="Adding the DaisywheelJS onscreen-keyboard to HTML5 Gamepad projects"></a>

                </div>

                <div class="recent-post-author-avatar">
                    <a href="/members#likethemammal" title="likethemammal">
                        <img class="recent-post-author-img" src="https://avatars1.githubusercontent.com/u/3430841" alt="likethemammal Avatar Image" title="likethemammal"/>
                    </a>
                </div>

            </li>

            

            

            

            

            

            

            

            

            

            

            

            

            

            <li class="recent-post cf">

                <div class="recent-post-words">

                    <div class="recent-post-title">

                        <h4 class="recent-post-title-text">
                            <a class="recent-post-title-text-link" href="/go-http/" title="Go's http package by example">
                                Go's http package by example
                            </a>

                            
                            <a class="post-tag" href="/tags/" title="golang">#golang</a>
                            
                            <a class="post-tag" href="/tags/" title="http">#http</a>
                            
                            <a class="post-tag" href="/tags/" title="middleware">#middleware</a>
                            

                        </h4>

                    </div>

                    <div class="recent-post-metadata">

                        <span class="recent-post-authoring-info">
                            <a href="/tags#mediocregopher" class="recent-post-author-name" title="Brian Picciano">Brian Picciano</a>
                            â€¢
                            <span class="recent-post-date">15 Jul 2015</span>
                        </span>

                    </div>

                    <a class="recent-post-link" href="/go-http/" title="Go's http package by example"></a>

                </div>

                <div class="recent-post-author-avatar">
                    <a href="/members#mediocregopher" title="mediocregopher">
                        <img class="recent-post-author-img" src="https://avatars.githubusercontent.com/u/933154" alt="mediocregopher Avatar Image" title="mediocregopher"/>
                    </a>
                </div>

            </li>

            

            

            

            

            

            

            

            

            

            

            

            <li class="recent-post cf">

                <div class="recent-post-words">

                    <div class="recent-post-title">

                        <h4 class="recent-post-title-text">
                            <a class="recent-post-title-text-link" href="/rabbit-hole/" title="Rabbit Hole">
                                Rabbit Hole
                            </a>

                            
                            <a class="post-tag" href="/tags/" title="debug">#debug</a>
                            
                            <a class="post-tag" href="/tags/" title="php">#php</a>
                            
                            <a class="post-tag" href="/tags/" title="sysdig">#sysdig</a>
                            
                            <a class="post-tag" href="/tags/" title="dns">#dns</a>
                            

                        </h4>

                    </div>

                    <div class="recent-post-metadata">

                        <span class="recent-post-authoring-info">
                            <a href="/tags#mediocregopher" class="recent-post-author-name" title="Brian Picciano">Brian Picciano</a>
                            â€¢
                            <span class="recent-post-date">11 Mar 2015</span>
                        </span>

                    </div>

                    <a class="recent-post-link" href="/rabbit-hole/" title="Rabbit Hole"></a>

                </div>

                <div class="recent-post-author-avatar">
                    <a href="/members#mediocregopher" title="mediocregopher">
                        <img class="recent-post-author-img" src="https://avatars.githubusercontent.com/u/933154" alt="mediocregopher Avatar Image" title="mediocregopher"/>
                    </a>
                </div>

            </li>

            

            

            

            

            

            

            

            

            

            

            

            <li class="recent-post cf">

                <div class="recent-post-words">

                    <div class="recent-post-title">

                        <h4 class="recent-post-title-text">
                            <a class="recent-post-title-text-link" href="/protip-sleep/" title="Protip - Bash Sleep">
                                Protip - Bash Sleep
                            </a>

                            
                            <a class="post-tag" href="/tags/" title="bash">#bash</a>
                            
                            <a class="post-tag" href="/tags/" title="protip">#protip</a>
                            

                        </h4>

                    </div>

                    <div class="recent-post-metadata">

                        <span class="recent-post-authoring-info">
                            <a href="/tags#mediocregopher" class="recent-post-author-name" title="Brian Picciano">Brian Picciano</a>
                            â€¢
                            <span class="recent-post-date">01 Dec 2014</span>
                        </span>

                    </div>

                    <a class="recent-post-link" href="/protip-sleep/" title="Protip - Bash Sleep"></a>

                </div>

                <div class="recent-post-author-avatar">
                    <a href="/members#mediocregopher" title="mediocregopher">
                        <img class="recent-post-author-img" src="https://avatars.githubusercontent.com/u/933154" alt="mediocregopher Avatar Image" title="mediocregopher"/>
                    </a>
                </div>

            </li>

            

            

            

            

            

            

            

        </ul>

    </div>

    

    <div id="bottom-tags" class="bottom-section">

        <h2 class="page-sub-header">Tags</h2>

        <ul id="bottom-tags-list">
            
            <li class="post-tag"><a href="/tags#aws" title="aws">#aws<span>(1)</span></a></li>
            
            <li class="post-tag"><a href="/tags#apache" title="apache">#apache<span>(1)</span></a></li>
            
            <li class="post-tag"><a href="/tags#bash" title="bash">#bash<span>(2)</span></a></li>
            
            <li class="post-tag"><a href="/tags#clojurescript" title="clojurescript">#clojurescript<span>(1)</span></a></li>
            
            <li class="post-tag"><a href="/tags#javascript" title="javascript">#javascript<span>(2)</span></a></li>
            
            <li class="post-tag"><a href="/tags#react" title="react">#react<span>(2)</span></a></li>
            
            <li class="post-tag"><a href="/tags#firebase" title="firebase">#firebase<span>(1)</span></a></li>
            
            <li class="post-tag"><a href="/tags#clojure" title="clojure">#clojure<span>(1)</span></a></li>
            
            <li class="post-tag"><a href="/tags#terrain" title="terrain">#terrain<span>(1)</span></a></li>
            
            <li class="post-tag"><a href="/tags#erlang" title="erlang">#erlang<span>(1)</span></a></li>
            
            <li class="post-tag"><a href="/tags#jekyll" title="jekyll">#jekyll<span>(2)</span></a></li>
            
            <li class="post-tag"><a href="/tags#github-pages" title="github-pages">#github-pages<span>(2)</span></a></li>
            
            <li class="post-tag"><a href="/tags#dev-blog" title="dev-blog">#dev-blog<span>(1)</span></a></li>
            
            <li class="post-tag"><a href="/tags#liquid" title="liquid">#liquid<span>(1)</span></a></li>
            
            <li class="post-tag"><a href="/tags#frp" title="frp">#frp<span>(1)</span></a></li>
            
            <li class="post-tag"><a href="/tags#functional" title="functional">#functional<span>(1)</span></a></li>
            
            <li class="post-tag"><a href="/tags#reactive" title="reactive">#reactive<span>(1)</span></a></li>
            
            <li class="post-tag"><a href="/tags#elm" title="elm">#elm<span>(1)</span></a></li>
            
            <li class="post-tag"><a href="/tags#om" title="om">#om<span>(1)</span></a></li>
            
            <li class="post-tag"><a href="/tags#protip" title="protip">#protip<span>(1)</span></a></li>
            
            <li class="post-tag"><a href="/tags#debug" title="debug">#debug<span>(1)</span></a></li>
            
            <li class="post-tag"><a href="/tags#php" title="php">#php<span>(1)</span></a></li>
            
            <li class="post-tag"><a href="/tags#sysdig" title="sysdig">#sysdig<span>(1)</span></a></li>
            
            <li class="post-tag"><a href="/tags#dns" title="dns">#dns<span>(1)</span></a></li>
            
            <li class="post-tag"><a href="/tags#golang" title="golang">#golang<span>(1)</span></a></li>
            
            <li class="post-tag"><a href="/tags#http" title="http">#http<span>(1)</span></a></li>
            
            <li class="post-tag"><a href="/tags#middleware" title="middleware">#middleware<span>(1)</span></a></li>
            
            <li class="post-tag"><a href="/tags#daisywheeljs" title="daisywheeljs">#daisywheeljs<span>(2)</span></a></li>
            
            <li class="post-tag"><a href="/tags#daisywheel" title="daisywheel">#daisywheel<span>(1)</span></a></li>
            
            <li class="post-tag"><a href="/tags#gamepad" title="gamepad">#gamepad<span>(2)</span></a></li>
            
            <li class="post-tag"><a href="/tags#html5" title="html5">#html5<span>(2)</span></a></li>
            
            <li class="post-tag"><a href="/tags#flux" title="flux">#flux<span>(1)</span></a></li>
            
        </ul>

    </div>
</footer>

<div id="copyright-band">

    <small id="copyright">Designed by <a href="http://likethemammal.com" title="Chris Dolphin's Personal Site">Chris Dolphin</a> and hosted on <a href="http://github.com/cryptic-io/cryptic-chat/" title="Cryptic IO Github Repo">Github</a></small>

</div>


  </body>

  

    <script type="text/javascript">
    var parent = (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]);
    var disqus_shortname = 'crypticio'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        parent.appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        parent.appendChild(s);
    }());
</script>


  

  <script>
    console.log(' \
           â–„â–„â–€â–€â–€â–€â–€â–€â–€â–€â–€â–„â–„             \n \
â–ˆâ–ˆâ–ˆâ–ˆâ–„   â–„â–ˆâ–€             â–€â–€â–„   â–„â–„â–ˆâ–ˆâ–ˆâ–€ \n \
   â–€â–ˆâ–ˆâ–ˆâ–ˆâ–Œ                  â–ˆâ–ˆâ–ˆâ–ˆâ–€â–€    \n \
      â–ˆâ–€â–ˆâ–ˆâ–ˆâ–„â–„          â–„â–ˆâ–ˆâ–ˆâ–ˆâ–€â–Œ       \n \
     â–ˆ    â–€â–€â–ˆâ–ˆâ–ˆâ–„â–„â–„â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–€    â–ˆ       \n \
     â–ˆ        â–€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€       â–â–Œ      \n \
     â–ˆ         â–€â–ˆâ–ˆâ–ˆâ–€         â–       \n \
     â–â–Œ         â–â–ˆâ–ˆ          â–ˆ       \n \
      â–â–ˆ        â–â–ˆâ–ˆ        â–„â–ˆ        \n \
        â–€â–„      â–â–ˆâ–ˆ       â–ˆâ–€         \n \
          â–€â–€â–„â–„  â–â–ˆâ–ˆ   â–„â–„â–€            \n \
              â–€â–€â–â–ˆâ–ˆâ–€â–€                \n \
                â–â–ˆâ–ˆ                  \n \
                â–â–ˆâ–ˆ                  \n \
                â–â–ˆâ–ˆ                  \
');
  </script>
</html>
